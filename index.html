<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>2D RepoVerse 🌌</title>
<style>
  body { margin:0; background:#111; font-family:sans-serif; color:white; }
  canvas { display:block; }
  #controls { position:absolute; top:10px; left:10px; }
  input { padding:5px; border-radius:4px; border:none; margin-bottom:5px; width:200px; }
  button { padding:5px; border-radius:4px; border:none; margin-left:5px; cursor:pointer; }
  #infoBox {
    position:absolute; top:10px; right:10px; background:rgba(20,20,20,0.9);
    padding:15px; border-radius:8px; width:300px; display:none;
  }
</style>
</head>
<body>

<div id="controls">
  <input id="username" placeholder="GitHub Username">
  <button id="loadBtn">Load Galaxy</button>
  <button id="activityBtn">GitHub Activity</button>
</div>

<div id="infoBox"></div>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const infoBox = document.getElementById('infoBox');

let planets = [];

// Color coding for languages
function languageToColor(lang) {
  switch(lang){
    case "JavaScript": return "#f1e05a";
    case "C#": return "#178600";
    case "C": return "#a8b9cc";
    case "Python": return "#3572A5";
    case "HTML": return "#e34c26";
    default: return "#888";
  }
}

// Fetch user repos
async function fetchRepos(username){
  try{
    const res = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
    if(!res.ok) throw new Error("User not found");
    return await res.json();
  } catch(e){
    alert(e.message);
    return [];
  }
}

// Build 2D galaxy
function buildGalaxy(repos){
  planets = [];
  const cx = canvas.width/2;
  const cy = canvas.height/2;
  const radiusStep = 50;

  repos.forEach((repo, i) => {
    const angle = (i / repos.length) * 2 * Math.PI;
    const r = radiusStep + (i % 5) * 20;
    planets.push({
      x: cx + Math.cos(angle)*r,
      y: cy + Math.sin(angle)*r,
      size: Math.log(repo.stargazers_count + 5)*3,
      color: languageToColor(repo.language),
      repo: repo
    });
  });

  draw();
}

// Draw 2D galaxy
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  planets.forEach(p => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
    ctx.fillStyle = p.color;
    ctx.fill();
  });
}

// Click handler
canvas.addEventListener('click', (e)=>{
  const mx = e.clientX;
  const my = e.clientY;
  planets.forEach(p=>{
    const dx = mx - p.x;
    const dy = my - p.y;
    if(Math.sqrt(dx*dx + dy*dy) <= p.size){
      showRepoInfo(p.repo);
    }
  });
});

function showRepoInfo(repo){
  infoBox.style.display = 'block';
  infoBox.innerHTML = `
    <h2>${repo.name}</h2>
    <p>${repo.description || "No description"}</p>
    <p>⭐ Stars: ${repo.stargazers_count}</p>
    <p>🍴 Forks: ${repo.forks_count}</p>
    <p>💬 Language: ${repo.language || "N/A"}</p>
    <a href="${repo.html_url}" target="_blank">🔗 Visit Repo</a>
  `;
}

// Load user galaxy
document.getElementById('loadBtn').addEventListener('click', async ()=>{
  const username = document.getElementById('username').value.trim();
  if(!username) return;
  const repos = await fetchRepos(username);
  buildGalaxy(repos);
});

// Simple GitHub activity demo: top repos by stars
document.getElementById('activityBtn').addEventListener('click', async ()=>{
  planets = [];
  const res = await fetch('https://api.github.com/search/repositories?q=stars:>10000&sort=stars&order=desc&per_page=50');
  const data = await res.json();
  const cx = canvas.width/2;
  const cy = canvas.height/2;
  const spacing = 50;
  data.items.forEach((repo, i)=>{
    planets.push({
      x: 50 + (i%10)*spacing,
      y: 100 + Math.floor(i/10)*spacing,
      size: Math.log(repo.stargazers_count)*0.5,
      color: languageToColor(repo.language),
      repo: repo
    });
  });
  draw();
});

// Resize canvas
window.addEventListener('resize', ()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  draw();
});
</script>

</body>
</html>
